package map;

import java.io.File;
import java.util.Iterator;
import java.util.List;

import org.jdom2.Element;
import org.jdom2.input.SAXBuilder;

public class XMLParser {
	
	private org.jdom2.Document document;
	private Element racine;
	
	/* Constructeur */

	public XMLParser(String filename) {
		// TODO Auto-generated constructor stub
		super();
		String workingDir = System.getProperty("user.dir");
		String finalfile = workingDir + File.separator + "data" + File.separator + filename;
		
		//On crée une instance de SAXBuilder
		SAXBuilder sxb = new SAXBuilder();
		try
		{
			//On crée un nouveau document JDOM avec en argument le fichier XML
			document = sxb.build(new File(finalfile));
		}
		catch(Exception e){e.printStackTrace();}
		finally
		{
			//On initialise un nouvel élément racine avec l'élément racine du document.
			racine = document.getRootElement();
		}
	}
	
	/* Données de la map */
	
	public String getMapName ()
	{
	   return racine.getAttributeValue("name");
	}
	
	public String getMapWidth ()
	{
		return racine.getAttributeValue("width");
	}
	
	public String getMapHeight ()
	{
		return racine.getAttributeValue("height");
	}
	
	/* Données de tiles */
	
	public List<Element> getMapTiles ()
	{
		List<Element> listTileTypes = (List<Element>) racine.getChildren();
		Iterator<Element> i = listTileTypes.iterator();
		while (i.hasNext())
		{
			Element current = i.next();
			Zone zone = null;
			switch (current.getName())
			{
				case "buttress" :
				{
					List<Element> listZones = current.getChildren("zone");
					while (i.hasNext())
					{
						List<Element> listTiles = current.getChildren("tile");
					}
					break;
				}
			}
			Iterator<Element> tile = listTiles.iterator ();
			while (tile.hasNext())
			{
				Element currentTile = tile.next();
				listAllTiles.add(currentTile);
			}
		}
		return listTiles;
	}

	/**
	 * @param args
	 */
	public static void main(String[] args) {
		// TODO Auto-generated method stub
		XMLParser parser = new XMLParser ("map1.xml");
		System.out.println(parser.getMapName());
		parser.getMapTiles();
	}

}
